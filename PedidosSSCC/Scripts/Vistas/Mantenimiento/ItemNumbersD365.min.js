function abrirModal(n){let t=JSON.parse(n.getAttribute("data-itemNumber"));$("#itemNumberId").val(t.IN3_Id);$("#descripcion").val(t.IN3_Nombre);$("#activo").prop("checked",t.IN3_Activo);$("#descripcion").removeClass("is-invalid");$("#modalEditar").modal("show")}async function eliminarItemNumberAjax(n){try{const t=await $.ajax({url:AppConfig.urls.EliminarItemNumber,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({idItemNumber:n}),dataType:"json"});t.success?(sessionStorage.removeItem("combo_item_number"),mostrarToast(AppConfig.mensajes.operacionOk,TipoToast.Success),$("#table").DataTable().ajax.reload(null,!1)):mostrarToast("No se puede eliminar el item number. Tiene relaciones",TipoToast.Warning)}catch(t){registrarErrorjQuery(t.status||"",t.message||t)}}function eliminarItemNumber(n){let t=JSON.parse(n.getAttribute("data-itemNumber"));mostrarAlertaConfirmacion({titulo:`¿Estás seguro de que deseas eliminar el item number '${t.IN3_Nombre}'?`,onConfirmar:()=>eliminarItemNumberAjax(producto.IN3_Id)})}$(document).ready(function(){function i(){let t=localStorage.getItem(n);t&&(t=JSON.parse(t),$("#formBuscar").val(t.general));t?.activo!==undefined&&$("#filterActivo").val(t.activo);r()}function t(){let t=$("#formBuscar").val(),i=$("#filterActivo").val(),r={general:t,activo:i};localStorage.setItem(n,JSON.stringify(r))}function r(){let n=inicializarDataTable("#table",{ajax:{url:AppConfig.urls.ObtenerItemNumbersD365,type:"GET",dataSrc:""},columns:[{data:"IN3_Id",title:"Id"},{data:"IN3_Nombre",title:"Descripción"},{data:"IN3_Activo",visible:!1,searchable:!0},{className:"dt-center ico-status",data:null,title:"Activo",orderable:!1,render:function(n,t,i,r){return`
                            <input type="checkbox" class="form-check-input"
                                id="checkbox-${r.row}"
                                data-index="${r.row}"
                                data-id="${i.IN3_Id}" disabled
                                ${i.IN3_Activo?"checked":""} />
                        `}},{className:"td-btn",data:null,title:'<span class="sReader">Acción<\/span>',responsivePriority:2,orderable:!1,render:function(n,t,i){return`
                                <button type="button" class="btn btn-icon btn-editar btn-outline-secondary"
                                        data-itemNumber="${JSON.stringify(i).replace(/"/g,"&quot;")}"
                                        onclick="abrirModal(this)">
                                    <i class="bi bi-pencil-square" title="Editar"></i>
                                </button>
                                <button type="button" class="btn btn-icon btn-eliminar btn-outline-secondary"
                                        data-itemNumber="${JSON.stringify(i).replace(/"/g,"&quot;")}"
                                        onclick="eliminarItemNumber(this)">
                                    <i class="bi bi-trash" title="Eliminar"></i>
                                </button>`}}]},[],"export_itemNumbers");$(window).resize(function(){n.columns.adjust().draw()});$("#formBuscar").on("keyup input",function(){n.search(this.value,!1,!1).draw();n.responsive.rebuild();n.responsive.recalc();n.columns.adjust();n.draw(!1);t()});$("#filterActivo").on("change",function(){let n=$(this).val();$("#table").DataTable().column(2).search(n).draw();t()})}let n="datatable_filters_tablaItemNumbers";VerificarSesionActiva(OpcionMenu.ItemNumbersD365).then(()=>{i()});$("#btnNuevo").on("click",function(){$("#itemNumberId").val("");$("#descripcion").val("");$("#activo").prop("checked",!1);$("#descripcion").removeClass("is-invalid");$("#modalEditar").modal("show")});$("#btnGuardar").on("click",function(){let n=$("#descripcion").val().trim(),t=[];if(n?$("#descripcion").removeClass("is-invalid"):($("#descripcion").addClass("is-invalid"),t.push("Descripción")),t.length>0){mostrarToast(AppConfig.mensajes.camposObligatorios,TipoToast.Warning);return}let i={IN3_Id:$("#itemNumberId").val(),IN3_Nombre:n,IN3_Activo:$("#activo").is(":checked")};$.ajax({url:AppConfig.urls.GuardarItemNumber,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(i),dataType:"json"}).done(function(n){if(n.success){sessionStorage.removeItem("combo_item_number");mostrarToast(AppConfig.mensajes.operacionOk,TipoToast.Success);$("#modalEditar").modal("hide");let n=$("#table").DataTable();n.ajax.reload(null,!1)}else mostrarToast("Error al guardar el item number.",TipoToast.Error)}).fail(function(n){const t=obtenerMensajeErrorAjax(n);registrarErrorjQuery(n.status,t)})})});