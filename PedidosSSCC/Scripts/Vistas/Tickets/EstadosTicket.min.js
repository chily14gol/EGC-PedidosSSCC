function abrirModalEstado(n){const t=JSON.parse(n.getAttribute("data-estado"));$("#estadoId").val(t.ETK_Id);$("#estadoNombre").val(t.ETK_Nombre);$("#estadoNombre").removeClass("is-invalid");$("#modalEstadoTicket").modal("show")}async function eliminarEstadoAjax(n){try{const t=await $.ajax({url:AppConfig.urls.EliminarEstadoTicket,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({idEstado:n}),dataType:"json"});t.success?(mostrarToast(AppConfig.mensajes.operacionOk,TipoToast.Success),$("#tablaEstados").DataTable().ajax.reload(null,!1)):mostrarToast("No se puede eliminar el estado.",TipoToast.Warning)}catch(t){registrarErrorjQuery(t.status||"",t.message||t)}}function eliminarEstado(n){const t=JSON.parse(n.getAttribute("data-estado"));mostrarAlertaConfirmacion({titulo:`¿Estás seguro de que deseas eliminar el estado '${t.ETK_Nombre}'?`,onConfirmar:()=>eliminarEstadoAjax(t.ETK_Id)})}$(document).ready(function(){function i(){const n=localStorage.getItem(t);if(n){const t=JSON.parse(n);$("#formBuscar").val(t.general)}u()}function r(){const n={general:$("#formBuscar").val()};localStorage.setItem(t,JSON.stringify(n))}function u(){const i=`#${n}`,t=inicializarDataTable(i,{ajax:{url:AppConfig.urls.ObtenerEstadosTicket,type:"GET",dataSrc:""},columns:[{data:"ETK_Id",title:"Id"},{data:"ETK_Nombre",title:"Nombre"},{className:"td-btn",data:null,title:'<span class="sReader">Acción<\/span>',responsivePriority:2,orderable:!1,render:function(n,t,i){return`
                            <button type="button" class="btn btn-icon btn-editar btn-outline-secondary"
                                    data-estado="${JSON.stringify(i).replace(/"/g,"&quot;")}"
                                    onclick="abrirModalEstado(this)">
                                <i class="bi bi-pencil-square" title="Editar"></i>
                            </button>
                            <button type="button" class="btn btn-icon btn-eliminar btn-outline-secondary"
                                    data-estado="${JSON.stringify(i).replace(/"/g,"&quot;")}"
                                    onclick="eliminarEstado(this)">
                                <i class="bi bi-trash" title="Eliminar"></i>
                            </button>`}}]},[],"export_estados");$(window).resize(()=>t.columns.adjust().draw());$("#formBuscar").on("keyup input",function(){t.search(this.value,!1,!1).draw();r()})}let n="tablaEstados",t="datatable_filters_"+n;VerificarSesionActiva(OpcionMenu.EstadosTicket).then(()=>{i()});$("#btnNuevo").on("click",function(){$("#estadoId").val("");$("#estadoNombre").val("");$("#estadoNombre").removeClass("is-invalid");$("#modalEstadoTicket").modal("show")});$("#btnGuardarEstado").on("click",function(){const t=$("#estadoNombre").val().trim();let i=[];if(t?$("#estadoNombre").removeClass("is-invalid"):($("#estadoNombre").addClass("is-invalid"),i.push("Nombre")),i.length>0){mostrarToast(AppConfig.mensajes.camposObligatorios,TipoToast.Warning);return}const r={ETK_Id:$("#estadoId").val(),ETK_Nombre:t};$.ajax({url:AppConfig.urls.GuardarEstadoTicket,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(r),dataType:"json"}).done(function(t){if(t.success){mostrarToast(AppConfig.mensajes.operacionOk,TipoToast.Success);$("#modalEstadoTicket").modal("hide");const t=`#${n}`;$(t).DataTable().ajax.reload(null,!1)}else mostrarToast(t.message||"Error al guardar el estado ticket.",TipoToast.Error)}).fail(function(n){const t=obtenerMensajeErrorAjax(n);registrarErrorjQuery(n.status,t)})});$("#modalEstadoTicket").on("hidden.bs.modal",function(){$("#estadoId").val("");$("#estadoNombre").val("");$("#estadoNombre").removeClass("is-invalid")});$("#modalEstadoTicket").modal({backdrop:"static",keyboard:!1})});